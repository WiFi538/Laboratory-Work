// 2. Дан массив целых положительных чисел. Сформировать новый массив, 
//состоящий из элементов исходного массива, начинающихся с заданной цифры Z.

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <ctype.h>

int main() {
    int n, Z;
    char input[100];

    //Вывод заголовка программы
    printf("Лабораторная работа №2, Часть 2\n");

    //Запрос размера массива
    printf("Введите размер массива (n): ");
    while (1) {
        if (fgets(input, sizeof(input), stdin) != NULL) { //Считываем строку с вводом
            if (sscanf(input, "%d", &n) == 1) { //Преобразуем строку в целое число
                if (n > 0) { //Проверка на положительность размера
                    break; //Выход из цикла, если размер корректен
                } else {
                    printf("Ошибка: размер массива должен быть положительным числом. Повторите ввод: ");
                }
            } else {
                printf("Неверный ввод. Пожалуйста, введите целое положительное число: ");
            }
        }
    }

    //Выделение памяти для исходного массива
    int *array = (int *)malloc(n * sizeof(int));

    //Запрос элементов исходного массива
    printf("Введите элементы массива:\n");
    for (int i = 0; i < n; i++) {
        while (1) {
            if (fgets(input, sizeof(input), stdin) != NULL) { //Считываем строку с вводом
                if (sscanf(input, "%d", &array[i]) == 1) { //Преобразуем строку в целое число
                    break; //Выход из цикла, если ввод корректен
                } else {
                    printf("Неверный ввод. Пожалуйста, введите целое число: ");
                }
            }
        }
    }

    //Запрос цифры Z
    printf("Введите цифру Z: ");
    while (1) {
        if (fgets(input, sizeof(input), stdin) != NULL) { //Считываем строку с вводом
            if (sscanf(input, "%d", &Z) == 1) { //Преобразуем строку в целое число
                if (Z >= 0 && Z <= 9) { //Проверка на диапазон от 0 до 9
                    break; //Выход из цикла, если цифра корректна
                } else {
                    printf("Ошибка: цифра Z должна быть в диапазоне от 0 до 9. Повторите ввод: ");
                }
            } else {
                printf("Неверный ввод. Пожалуйста, введите цифру от 0 до 9: ");
            }
        }
    }

    //Формирование нового массива
    int *newArray = (int *)malloc(n * sizeof(int)); //Выделение памяти для нового массива
    int newArraySize = 0; //Размер нового массива

    for (int i = 0; i < n; i++) {
        int temp = array[i];
        int firstDigit = temp < 0 ? -temp : temp; //Если число отрицательное, берем его модуль
        while (firstDigit >= 10) {
            firstDigit /= 10; //Определяем первую цифру числа
        }
        if (firstDigit == Z) { //Если первая цифра совпадает с Z
            newArray[newArraySize++] = array[i]; //Добавляем элемент в новый массив
        }
    }

    //Вывод результата
    printf("Результат:\n");
    for (int i = 0; i < newArraySize; i++) {
        printf("%d ", newArray[i]); //Вывод элементов нового массива
    }
    printf("\n");

    //Освобождение памяти
    free(array); //Освобождение памяти, выделенной для исходного массива
    free(newArray); //Освобождение памяти, выделенной для нового массива

    return 0;
}
